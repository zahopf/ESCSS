@model ESCS.Domain.Goods
@{
    Layout = "~/Views/Shared/_LayoutEscs.cshtml";
}
    <link href="~/layui-v2.5.7/layui/css/layui.css" rel="stylesheet" />
    <script src="~/layui-v2.5.7/layui/layui.js"></script>
    <script src="~/Scripts/jquery.validate.unobtrusive.min.js"></script>
    <script src="~/Scripts/jquery.min.js"></script>
    <style type="text/css">
        .layui-table-cell {
            height: auto;
            line-height: 90px;
        }
    </style>
    
    
<div style=" height:15vh;width:100vw;">
    <div style="height: 8vh; width: 15vh; background-color: #ffffff; float:left;margin:5vh 0 0 19vw;border-radius:40%;text-align:center;font-size:35px;font-weight:600;color:#ff6a00;">
        <p>易购</p>
        <p style="font-size:25px;">YI GOU</p>
    </div>
    <div style="margin: 6vh 25vw 0 0; float: right; text-align: center; font-size: 20px; font-weight: 600; color: #ff6a00; ">
        <p>提交订单</p>
        @*<div data-toggle="arrowdown" id="arrow8" class="search-toggle">
                宝贝
            </div>
            <input class="search-in" type="text" name="goodsName" placeholder="    搜‘健康椅’试试，办公好选择">
            <input type="button" class="search-but" value="搜索" style="width:95px;">*@

    </div>
</div>

    <div style=" width:45vw; height: auto;  padding: 0px 70px 30px 0; position: relative;margin-left:23vw;">
        <div style="height:auto; width: 100%;  text-align: center; margin-top:30px;background-color:#ebdddd;">
            <form class="layui-form" action="">
                @foreach (var item in @ViewBag.Address as IList<ESCS.Domain.Address>)
                {
                    <input type="radio" name="AddressName" value=@item.ID title=@item.AddressingDetail id="@item.IsActive.ToString()" lay-filter="ChoiceRadio" style="color:black;">
                }
            </form>

        </div>

@using (Html.BeginForm())
            {
        <div style="margin-top:110px;margin-left:-50px;">
            <table lay-filter="demo2" id="demo2" lay-data="{initSort:{field:'id', type:'null'}}">
                <thead>
                    <tr>
                        <th lay-data="{field:'Id',align:'center'}">
                            图片
                        </th>
                        <th lay-data="{field:'I',align:'center'}">
                            商品名
                        </th>
                        <th lay-data="{field:'q',align:'center'}">
                            单价
                        </th>
                        <th lay-data="{field:'p',align:'center'}">
                            库存
                        </th>

                    </tr>
                </thead>
                <tbody>
                        <tr >
                            <td >
                                <img style="width:100%;height:100%" src="@Url.Content(@Model.Picture)"  />
                            </td>
                            <td>
                                @Model.GoodsName
                            </td>
                            <td>
                                @Model.OutPrice
                            </td>
                            <td>
                                @Model.Stock

                            </td>
                        </tr>

                </tbody>
            </table>
        </div>
        @*<div>
            <label>数量：</label>
            <div style="margin-right:150px;">
                <input style="width:30px;height:30px;" id="min" name="" type="button" value="-" />
                <input style="width: 60px; text-align: center; height: 26px;" id="Quantity" autocomplete="off" name="Quantity" type="text" value="@ViewBag.Quantity" />
                <input style="width: 30px; height: 30px;" id="add" name="" type="button" value="+" />
            </div>
        </div>*@
        <div style="float: left; width: 21vw; height: 200px;float:right;margin-top:10px;padding:60px 0 0 0;">
                    <form class="layui-form" action="">
                        <div class="layui-form-item">
                            <p style="font-size:20px;">
                                <span>数量：</span>
                                <span class="orange">
                                    <input style="width:30px;height:30px;" id="min" name="" type="button" value="-" />
                                    <input style="width: 60px; text-align: center;  height: 26px;" min="1" max="@Model.Stock" id="Quantity" autocomplete="off" name="Quantity" type="text" value="@ViewBag.Quantity" />
                                    <input style="width: 30px; height: 30px;" id="add" name="" type="button" value="+" />
                                </span>
                            </p>
                            <p id="Qbig" style="color:red;"></p>
                        </div>
                        <div class="layui-form-item">
                            <p style="font-size:30px;">
                                <span>总金额：</span>
                                <span class="orange">￥&nbsp;</span>
                                <span style="color:red;" id="AllPice">￥&nbsp0.00</span>
                                <span class="send-free">包邮</span>
                            </p>
                        </div>
                        <input type="hidden" name="ids" value="@Model.ID" />
                        <input type="hidden" id="AddressName" value="" name="dz" />
                        <input type="hidden" value="@ViewBag.Car" name="car" />
                        <div style="text-align:center;margin-top:20px;margin-right:10vw;margin-top:30px;">
                            <button onclick="open_win()" type="submit" class="layui-btn layui-btn-radius" style="word-spacing: 15px;" id="tj">确认支付</button>
                        </div>
                        </form>
            </div>
        
        

}
    </div>
<input type="hidden" value="@Model.Stock" id="Stock" />
<div style="height:10vh;"></div>
<script src="~/Content/Quantity.js"></script>
<script>
    //获取默认地址（使默认地址为选择状态）
    document.getElementById("True").checked = "checked";


    

    $('#tj').on('click', function () {

        if ($("#Quantity").val() == "") {
            $("#Quantity").val("1");

        }

        $("#AddressName").val($('input[name="AddressName"]:checked').val());


    });

</script>
<script>
    setInterval(function () {
        var Quantity = document.getElementById("Quantity").value;
        
        
        var OutPict = @Model.OutPrice
        //alert(OutPict);
        document.getElementById("AllPice").innerText = Quantity * OutPict;
        var Stock = document.getElementById("Stock").value;
        if (Number(Stock) < Number(Quantity)) {
            //alert("购买数量不允许超过库存！！！");
            document.getElementById("Qbig").innerText = "购买数量不允许超过库存！！！";
        }
        else if (Number(Quantity) <= 0) {
            //alert("购买数量不允许超过库存！！！");
            document.getElementById("Qbig").innerText = "购买数量不允许小于等于0！！！";
        }
        else { document.getElementById("Qbig").innerText = null; }
    }, 500);
    @*function open_win() {
        
        window.open("@Url.Content("~/EasyShoppingCentre/Pay")", '', "height = 300, width = 400,resizable=0,top=350,left=600,location=no");
        sleep(100000);
    }*@
</script>
